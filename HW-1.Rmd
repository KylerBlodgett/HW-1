---
title: "MATH 216 Homework 1"
author: "WRITE YOUR NAME HERE"
output: html_document
---

```{r, echo=FALSE, message=FALSE}
# DO NOT EDIT THIS SECTION

# Load packages
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(lubridate))
```


```{r, echo=FALSE, message=FALSE, cache=TRUE}
# Load data sets. Note this assumes this .Rmd files is in the same directory as
# the .csv files.
flights <- read.csv("data/flights.csv", stringsAsFactors = FALSE) %>% 
  tbl_df() %>%
  mutate(date=as.Date(date))
weather <- read.csv("data/weather.csv", stringsAsFactors = FALSE) %>% 
  tbl_df() %>%
  mutate(date=as.Date(date))
planes <- read.csv("data/planes.csv", stringsAsFactors = FALSE) %>% 
  tbl_df()
airports <- read.csv("data/airports.csv", stringsAsFactors = FALSE) %>% 
  tbl_df()
states <- read.csv("data/states.csv", stringsAsFactors = FALSE) %>% 
  tbl_df()
```





## Admistrative:

Please indicate

* Who you collaborated with:
* Roughly how much time you spent on this HW:
* What gave you the most trouble:
* Any comments you have:





## Question 1:

* Plot a "time series" of the proportion of flights that were delayed by > 30 minutes on each day.  i.e.
    + the x-axis should be some notion of time
    + the y-axis should be the proportion.
* Which seasons did we tend to see the most and least delays of > 30 minutes.

```{r, echo=FALSE, message=FALSE, fig.width=12, fig.height=6}

```





## Question 2:

Some people prefer flying on older planes.  Even though they aren't as nice,
they tend to have more room.  Which airlines should these people favor?

```{r, echo=FALSE, fig.width=12, fig.height=6}
old_planes <- (left_join(flights, planes, by = "plane") %>%
  select(plane, carrier, year) %>%
  arrange(carrier, year) %>%
  group_by(carrier, year) %>%
  tally () %>%
  rename(num_in_year = n) )
ggplot(data=old_planes, aes(x = year, y = num_in_year, colour = carrier)) +
  geom_dotplot() + #not sure how to make it visually better while using dotplot? It was OK with geom_point
  scale_y_log10() +
  facet_wrap(~carrier, nrow=4) +
  ggtitle("Age of Planes by Airline") 
```

From these graphs, we can see visually that the AA airline used the oldest planes  in their departures from the Dallas airport during January 2011. CO and DL also have fairly old fleets for that time window, with some planes made in the 1950s, and hundreds dating back to the 1970s. All other carriers have planes manufactured predominantly since the mid- to late-1980s.





## Question 3:

* What states did listed Southwest Airlines flights tend to fly to?
* What states did all Southwest Airlines flights tend to fly to?


```{r, echo=FALSE, message=FALSE, fig.width=12, fig.height=6}
WN_flights <- 
  left_join(flights, airports, by=c("dest"="iata")) %>%
  filter(carrier == "WN") %>%
  group_by(state) %>%
  tally() %>%
  rename(num_WN_flights = n)
  
ggplot(data=WN_flights, aes(x = state)) +
  geom_bar(aes(y=..count..)) +
  ggtitle("WN Flights by State") #Not right, think I'm missing some argument for geom_bar
```





## Question 4:

What weather patterns are associated with the biggest departure delays?

```{r, echo=FALSE, message=FALSE, fig.width=12, fig.height=6}

```





## Question 5:

I want to know what proportionately regions (NE, south, west, midwest) each 
carrier flies to from Houston in the month of July.  Consider the `month()`
function from the `lubridate` package.

```{r, echo=FALSE, message=FALSE, fig.width=12, fig.height=6}

```
